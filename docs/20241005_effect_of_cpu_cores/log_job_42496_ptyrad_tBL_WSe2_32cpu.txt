/home/fs01/cl2696/workspace/ptyrad
c0004
Fri Oct  4 10:49:58 EDT 2024
params_path = params/demo/tBL_WSe2_reconstruct.yml

PtyRAD version: v0.1.0-beta2.6-acc
### Loading params file ###
Success! Loaded .yml file path = params/demo/tBL_WSe2_reconstruct.yml
PyTorch version:  2.1.2
CUDA available:  True
CUDA version:  11.8
CUDA device:  ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Selected GPU device: cuda:0 (NVIDIA A100-SXM4-80GB MIG 2g.20gb)

ACCELERATE_AVAILABLE = False

### Initializing Initializer ###

### Initializing cache ###
use_cached_obj   = False
use_cached_probe = False
use_cached_pos   = False

### Initializing exp_params ###
Input values are displayed below:
kv: 80
conv_angle: 24.9
Npix: 128
dx_spec: 0.1494
defocus: 0
c3: 0
c5: 0
z_distance: 2
Nlayer: 6
N_scans: 16384
N_scan_slow: 128
N_scan_fast: 128
scan_step_size: 0.429
scan_flipT: None
scan_affine: None
scan_rand_std: 0.15
omode_max: 1
omode_init_occu: {'occu_type': 'uniform', 'init_occu': None}
pmode_max: 12
pmode_init_pows: [0.02]
probe_permute: None
meas_permute: None
meas_reshape: None
meas_flipT: [1, 0, 0]
meas_crop: None
meas_resample: {'mode': None, 'scale_factors': [2, 2]}
meas_add_source_size: None
meas_add_detector_blur: None
meas_add_poisson_noise: None

Derived values given input exp_params:
kv          = 80 kV
wavelength  = 0.0418 Ang
conv_angle  = 24.9 mrad
Npix        = 128 px
dk          = 0.0523 Ang^-1
kMax        = 3.3467 Ang^-1
alpha_max   = 139.7495 mrad
dx          = 0.1494 Ang, Nyquist-limited dmin = 2*dx = 0.2988 Ang
Rayleigh-limited resolution  = 1.0230 Ang (0.61*lambda/alpha for focused probe )
Real space probe extent = 19.1232 Ang

### Initializing measurements from 'raw' ###
Imported meausrements shape = (16384, 128, 128)
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Radius of bright field disk             (rbf) = 11.0 px, suggested probe_mask_k radius (rbf*2/Npix) > 0.17
meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
measurements                      (N, Ky, Kx) = float32, (16384, 128, 128)

### Initializing probe from 'simu' ###
Use exp_params and default values instead for simulation
Start simulating STEM probe
kv          = 80.0 kV
wavelength  = 0.0418 Ang
conv_angle  = 24.9 mrad
Npix        = 128 px
dk          = 0.0523 Ang^-1
kMax        = 3.3467 Ang^-1
alpha_max   = 139.7447 mrad
dx          = 0.1494 Ang, Nyquist-limited dmin = 2*dx = 0.2988 Ang
Rayleigh-limited resolution  = 1.0229 Ang (0.61*lambda/alpha for focused probe )
Real space probe extent = 19.1232 Ang
Start making mixed-state STEM probe with 12 incoherent probe modes
Relative power of probe modes = [0.78 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02]
probe                         (pmode, Ny, Nx) = complex64, (12, 128, 128)
sum(|probe_data|**2) = 450.46, while sum(meas)/len(meas) = 450.46

### Initializing probe pos from 'simu' ###
Simulating probe positions with dx_spec = 0.1494, scan_step_size = 0.429, N_scan_fast = 128, N_scan_slow = 128
Applying Gaussian distributed random displacement with std = 0.15 px to scan positions
crop_pos                                (N,2) = int16, (16384, 2)
crop_pos 1st and last px coords (y,x)         = ([50, 50], [414, 414])
crop_pos extent (Ang)                         = [54.6804 54.6804]
probe_pos_shifts                        (N,2) = float32, (16384, 2)

### Initializing obj from 'simu' ###
obj_shape is not provided, use exp_params, position range, and probe shape for estimated obj_shape (omode, Nz, Ny, Nx)
object                    (omode, Nz, Ny, Nx) = complex64, (1, 6, 592, 592)
object extent                 (Z, Y, X) (Ang) = [12.     88.4448 88.4448]

### Initializing omode_occu from 'uniform' ###
omode_occu                            (omode) = float32, (1,)

### Initializing H (Fresnel propagator) ###
Calculating H with probe_shape = [128 128], z_distance = 2.0000 Ang, lambd = 0.0418 Ang, extent = [19.1232 19.1232] Ang
H                                    (Ky, Kx) = complex64, (128, 128)

### Initializing obj tilts from = 'simu' ###
Initialized obj_tilts with init_tilts = [[0, 0]] (theta_y, theta_x) mrad
obj_tilts                              (N, 2) = float32, (1, 2)

### Checking consistency between input params with the initialized variables ###
Npix, DP measurements, probe, and H shapes are consistent as '128'
N_scans, len(meas), N_scan_slow*N_scan_fast, len(crop_pos), and len(probe_pos_shifts) are consistent as '16384'
obj.shape[0] is consistent with len(omode_occu) as '1'
obj.shape[1] is consistent with Nlayer as '6'
obj_tilts is consistent with either 1 or N_scans
Pass the consistency check of initialized variables, initialization is done!

### Initializing loss function ###

### Initializing constraint function ###

### Done initializing PtyRADSolver ###

### Starting the PtyRADSolver in reconstruct mode ###

### PtychoAD optimizable variables ###
obja            : torch.Size([1, 6, 592, 592])    , torch.float32   , device:cuda:0, grad:True , lr:8e-03
objp            : torch.Size([1, 6, 592, 592])    , torch.float32   , device:cuda:0, grad:True , lr:8e-03
obj_tilts       : torch.Size([1, 2])              , torch.float32   , device:cuda:0, grad:False, lr:0e+00
probe           : torch.Size([12, 128, 128, 2])   , torch.float32   , device:cuda:0, grad:True , lr:2e-03
probe_pos_shifts: torch.Size([16384, 2])          , torch.float32   , device:cuda:0, grad:True , lr:8e-03

### Optimizable variables statitsics ###
Total measurement values:    268,435,456                
Total optimizing variables:  4,631,552                
Overdetermined ratio:        57.96

### Model behavior ###
Obj preblur             : False
Tilt propagator         : False
Sub-px probe shift      : True
Detector blur           : False
On-the-fly meas resample: False

### Creating PyTorch 'Adam' optimizer with configs = {'fused': False} ###

### Generating indices, batches, and output_path ###
d90 = 31.000 px or 4.631 Ang
Selecting indices with the 'full' mode 
Generated 128 'random' groups of ~128 scan positions in 0.001 sec
The effective batch size (i.e., how many probe positions are simultaneously used for 1 update of ptychographic parameters) is batch_size * grad_accumulation = 128 * 1 = 128
output_path = 'output/tBL-WSe2//20241004_full_N16384_dp128_flipT100_random128_p12_1obj_6slice_dz2_Adam_plr2e-3_oalr8e-3_oplr8e-3_slr8e-3_orblur0.2_ozblur1_oathr0.98_opos_sng1.0_spr0.1_32cpu' is generated!
Successfully copy 'tBL_WSe2_reconstruct.yml' to 'output/tBL-WSe2//20241004_full_N16384_dp128_flipT100_random128_p12_1obj_6slice_dz2_Adam_plr2e-3_oalr8e-3_oplr8e-3_slr8e-3_orblur0.2_ozblur1_oathr0.98_opos_sng1.0_spr0.1_32cpu'

### Start the PtyRAD iterative ptycho reconstruction ###
Iter: 1, obja.requires_grad = True
Iter: 1, objp.requires_grad = True
Iter: 1, obj_tilts.requires_grad = False
Iter: 1, probe.requires_grad = True
Iter: 1, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.231 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 1, relative pmode power = [0.67  0.045 0.038 0.037 0.033 0.028 0.028 0.026 0.025 0.024 0.023 0.022], probe int sum = 517.4859
Apply fix probe int constraint at iter 1, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 1
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 1
Apply z-direction Gaussian blur with std = 1 px on obja at iter 1
Apply z-direction Gaussian blur with std = 1 px on objp at iter 1
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 1
Apply hard positivity constraint on objp at iter 1
Iter: 1, Total Loss: 0.3542, loss_single: 0.3521, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 24.867 sec

Iter: 2, obja.requires_grad = True
Iter: 2, objp.requires_grad = True
Iter: 2, obj_tilts.requires_grad = False
Iter: 2, probe.requires_grad = True
Iter: 2, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.178 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 2, relative pmode power = [0.551 0.067 0.055 0.054 0.05  0.04  0.039 0.033 0.031 0.03  0.028 0.022], probe int sum = 531.9858
Apply fix probe int constraint at iter 2, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 2
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 2
Apply z-direction Gaussian blur with std = 1 px on obja at iter 2
Apply z-direction Gaussian blur with std = 1 px on objp at iter 2
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 2
Apply hard positivity constraint on objp at iter 2
Iter: 2, Total Loss: 0.2696, loss_single: 0.2678, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0018, loss_simlar: 0.0000, in 22.162 sec

Iter: 3, obja.requires_grad = True
Iter: 3, objp.requires_grad = True
Iter: 3, obj_tilts.requires_grad = False
Iter: 3, probe.requires_grad = True
Iter: 3, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 3, relative pmode power = [0.438 0.08  0.078 0.067 0.066 0.049 0.046 0.039 0.039 0.037 0.033 0.028], probe int sum = 561.7730
Apply fix probe int constraint at iter 3, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 3
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 3
Apply z-direction Gaussian blur with std = 1 px on obja at iter 3
Apply z-direction Gaussian blur with std = 1 px on objp at iter 3
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 3
Apply hard positivity constraint on objp at iter 3
Iter: 3, Total Loss: 0.2527, loss_single: 0.2507, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0020, loss_simlar: 0.0000, in 22.180 sec

Iter: 4, obja.requires_grad = True
Iter: 4, objp.requires_grad = True
Iter: 4, obj_tilts.requires_grad = False
Iter: 4, probe.requires_grad = True
Iter: 4, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 4, relative pmode power = [0.388 0.081 0.077 0.064 0.06  0.055 0.051 0.049 0.049 0.049 0.042 0.035], probe int sum = 520.7611
Apply fix probe int constraint at iter 4, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 4
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 4
Apply z-direction Gaussian blur with std = 1 px on obja at iter 4
Apply z-direction Gaussian blur with std = 1 px on objp at iter 4
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 4
Apply hard positivity constraint on objp at iter 4
Iter: 4, Total Loss: 0.2447, loss_single: 0.2426, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.189 sec

Iter: 5, obja.requires_grad = True
Iter: 5, objp.requires_grad = True
Iter: 5, obj_tilts.requires_grad = False
Iter: 5, probe.requires_grad = True
Iter: 5, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 5, relative pmode power = [0.347 0.084 0.072 0.069 0.061 0.06  0.057 0.056 0.054 0.054 0.044 0.042], probe int sum = 515.3768
Apply fix probe int constraint at iter 5, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 5
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 5
Apply z-direction Gaussian blur with std = 1 px on obja at iter 5
Apply z-direction Gaussian blur with std = 1 px on objp at iter 5
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 5
Apply hard positivity constraint on objp at iter 5
Iter: 5, Total Loss: 0.2400, loss_single: 0.2380, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.188 sec

Iter: 6, obja.requires_grad = True
Iter: 6, objp.requires_grad = True
Iter: 6, obj_tilts.requires_grad = False
Iter: 6, probe.requires_grad = True
Iter: 6, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 6, relative pmode power = [0.324 0.087 0.074 0.07  0.066 0.063 0.062 0.057 0.056 0.054 0.045 0.042], probe int sum = 494.3186
Apply fix probe int constraint at iter 6, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 6
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 6
Apply z-direction Gaussian blur with std = 1 px on obja at iter 6
Apply z-direction Gaussian blur with std = 1 px on objp at iter 6
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 6
Apply hard positivity constraint on objp at iter 6
Iter: 6, Total Loss: 0.2369, loss_single: 0.2349, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.199 sec

Iter: 7, obja.requires_grad = True
Iter: 7, objp.requires_grad = True
Iter: 7, obj_tilts.requires_grad = False
Iter: 7, probe.requires_grad = True
Iter: 7, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.174 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 7, relative pmode power = [0.31  0.088 0.079 0.071 0.07  0.07  0.063 0.061 0.054 0.047 0.046 0.039], probe int sum = 483.0530
Apply fix probe int constraint at iter 7, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 7
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 7
Apply z-direction Gaussian blur with std = 1 px on obja at iter 7
Apply z-direction Gaussian blur with std = 1 px on objp at iter 7
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 7
Apply hard positivity constraint on objp at iter 7
Iter: 7, Total Loss: 0.2347, loss_single: 0.2327, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.207 sec

Iter: 8, obja.requires_grad = True
Iter: 8, objp.requires_grad = True
Iter: 8, obj_tilts.requires_grad = False
Iter: 8, probe.requires_grad = True
Iter: 8, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.177 sec
Apply ortho pmode constraint at iter 8, relative pmode power = [0.301 0.089 0.077 0.076 0.072 0.068 0.067 0.066 0.053 0.05  0.044 0.038], probe int sum = 476.5450
Apply fix probe int constraint at iter 8, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 8
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 8
Apply z-direction Gaussian blur with std = 1 px on obja at iter 8
Apply z-direction Gaussian blur with std = 1 px on objp at iter 8
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 8
Apply hard positivity constraint on objp at iter 8
Iter: 8, Total Loss: 0.2338, loss_single: 0.2318, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.213 sec

Iter: 9, obja.requires_grad = True
Iter: 9, objp.requires_grad = True
Iter: 9, obj_tilts.requires_grad = False
Iter: 9, probe.requires_grad = True
Iter: 9, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.174 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 9, relative pmode power = [0.3   0.094 0.085 0.073 0.073 0.072 0.06  0.057 0.054 0.048 0.046 0.038], probe int sum = 464.8066
Apply fix probe int constraint at iter 9, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 9
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 9
Apply z-direction Gaussian blur with std = 1 px on obja at iter 9
Apply z-direction Gaussian blur with std = 1 px on objp at iter 9
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 9
Apply hard positivity constraint on objp at iter 9
Iter: 9, Total Loss: 0.2338, loss_single: 0.2317, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.179 sec

Iter: 10, obja.requires_grad = True
Iter: 10, objp.requires_grad = True
Iter: 10, obj_tilts.requires_grad = False
Iter: 10, probe.requires_grad = True
Iter: 10, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.174 sec
Apply ortho pmode constraint at iter 10, relative pmode power = [0.294 0.095 0.09  0.077 0.072 0.062 0.06  0.059 0.056 0.05  0.045 0.04 ], probe int sum = 473.2147
Apply fix probe int constraint at iter 10, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 10
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 10
Apply z-direction Gaussian blur with std = 1 px on obja at iter 10
Apply z-direction Gaussian blur with std = 1 px on objp at iter 10
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 10
Apply hard positivity constraint on objp at iter 10
Iter: 10, Total Loss: 0.2334, loss_single: 0.2314, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.188 sec

Saving summary figures for iter 10

### Finished 100 iterations, averaged iter_t = 22.5 sec ###
Iter: 11, obja.requires_grad = True
Iter: 11, objp.requires_grad = True
Iter: 11, obj_tilts.requires_grad = False
Iter: 11, probe.requires_grad = True
Iter: 11, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.179 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.174 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.174 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.174 sec
Apply ortho pmode constraint at iter 11, relative pmode power = [0.285 0.094 0.093 0.083 0.071 0.062 0.058 0.058 0.054 0.053 0.046 0.042], probe int sum = 476.2806
Apply fix probe int constraint at iter 11, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 11
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 11
Apply z-direction Gaussian blur with std = 1 px on obja at iter 11
Apply z-direction Gaussian blur with std = 1 px on objp at iter 11
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 11
Apply hard positivity constraint on objp at iter 11
Iter: 11, Total Loss: 0.2316, loss_single: 0.2295, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.213 sec

Iter: 12, obja.requires_grad = True
Iter: 12, objp.requires_grad = True
Iter: 12, obj_tilts.requires_grad = False
Iter: 12, probe.requires_grad = True
Iter: 12, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 12, relative pmode power = [0.279 0.094 0.093 0.091 0.071 0.063 0.06  0.056 0.051 0.051 0.046 0.045], probe int sum = 473.2123
Apply fix probe int constraint at iter 12, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 12
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 12
Apply z-direction Gaussian blur with std = 1 px on obja at iter 12
Apply z-direction Gaussian blur with std = 1 px on objp at iter 12
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 12
Apply hard positivity constraint on objp at iter 12
Iter: 12, Total Loss: 0.2312, loss_single: 0.2292, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.205 sec

Iter: 13, obja.requires_grad = True
Iter: 13, objp.requires_grad = True
Iter: 13, obj_tilts.requires_grad = False
Iter: 13, probe.requires_grad = True
Iter: 13, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 13, relative pmode power = [0.278 0.097 0.087 0.085 0.073 0.065 0.064 0.056 0.051 0.051 0.048 0.045], probe int sum = 463.6930
Apply fix probe int constraint at iter 13, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 13
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 13
Apply z-direction Gaussian blur with std = 1 px on obja at iter 13
Apply z-direction Gaussian blur with std = 1 px on objp at iter 13
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 13
Apply hard positivity constraint on objp at iter 13
Iter: 13, Total Loss: 0.2309, loss_single: 0.2288, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.159 sec

Iter: 14, obja.requires_grad = True
Iter: 14, objp.requires_grad = True
Iter: 14, obj_tilts.requires_grad = False
Iter: 14, probe.requires_grad = True
Iter: 14, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 14, relative pmode power = [0.275 0.097 0.086 0.083 0.074 0.068 0.064 0.056 0.055 0.05  0.05  0.041], probe int sum = 466.5388
Apply fix probe int constraint at iter 14, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 14
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 14
Apply z-direction Gaussian blur with std = 1 px on obja at iter 14
Apply z-direction Gaussian blur with std = 1 px on objp at iter 14
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 14
Apply hard positivity constraint on objp at iter 14
Iter: 14, Total Loss: 0.2306, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.159 sec

Iter: 15, obja.requires_grad = True
Iter: 15, objp.requires_grad = True
Iter: 15, obj_tilts.requires_grad = False
Iter: 15, probe.requires_grad = True
Iter: 15, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 15, relative pmode power = [0.268 0.096 0.088 0.084 0.074 0.069 0.063 0.061 0.057 0.052 0.049 0.04 ], probe int sum = 472.2978
Apply fix probe int constraint at iter 15, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 15
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 15
Apply z-direction Gaussian blur with std = 1 px on obja at iter 15
Apply z-direction Gaussian blur with std = 1 px on objp at iter 15
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 15
Apply hard positivity constraint on objp at iter 15
Iter: 15, Total Loss: 0.2305, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.221 sec

Iter: 16, obja.requires_grad = True
Iter: 16, objp.requires_grad = True
Iter: 16, obj_tilts.requires_grad = False
Iter: 16, probe.requires_grad = True
Iter: 16, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 16, relative pmode power = [0.259 0.094 0.089 0.084 0.073 0.068 0.066 0.065 0.059 0.054 0.049 0.039], probe int sum = 478.7252
Apply fix probe int constraint at iter 16, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 16
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 16
Apply z-direction Gaussian blur with std = 1 px on obja at iter 16
Apply z-direction Gaussian blur with std = 1 px on objp at iter 16
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 16
Apply hard positivity constraint on objp at iter 16
Iter: 16, Total Loss: 0.2305, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.153 sec

Iter: 17, obja.requires_grad = True
Iter: 17, objp.requires_grad = True
Iter: 17, obj_tilts.requires_grad = False
Iter: 17, probe.requires_grad = True
Iter: 17, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 17, relative pmode power = [0.245 0.092 0.089 0.084 0.075 0.072 0.07  0.066 0.061 0.058 0.049 0.039], probe int sum = 490.7739
Apply fix probe int constraint at iter 17, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 17
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 17
Apply z-direction Gaussian blur with std = 1 px on obja at iter 17
Apply z-direction Gaussian blur with std = 1 px on objp at iter 17
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 17
Apply hard positivity constraint on objp at iter 17
Iter: 17, Total Loss: 0.2306, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.147 sec

Iter: 18, obja.requires_grad = True
Iter: 18, objp.requires_grad = True
Iter: 18, obj_tilts.requires_grad = False
Iter: 18, probe.requires_grad = True
Iter: 18, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 18, relative pmode power = [0.231 0.092 0.089 0.086 0.084 0.076 0.069 0.067 0.065 0.061 0.042 0.039], probe int sum = 501.2548
Apply fix probe int constraint at iter 18, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 18
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 18
Apply z-direction Gaussian blur with std = 1 px on obja at iter 18
Apply z-direction Gaussian blur with std = 1 px on objp at iter 18
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 18
Apply hard positivity constraint on objp at iter 18
Iter: 18, Total Loss: 0.2310, loss_single: 0.2289, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.150 sec

Iter: 19, obja.requires_grad = True
Iter: 19, objp.requires_grad = True
Iter: 19, obj_tilts.requires_grad = False
Iter: 19, probe.requires_grad = True
Iter: 19, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.174 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 19, relative pmode power = [0.243 0.104 0.101 0.095 0.08  0.072 0.069 0.066 0.053 0.044 0.039 0.034], probe int sum = 454.1236
Apply fix probe int constraint at iter 19, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 19
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 19
Apply z-direction Gaussian blur with std = 1 px on obja at iter 19
Apply z-direction Gaussian blur with std = 1 px on objp at iter 19
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 19
Apply hard positivity constraint on objp at iter 19
Iter: 19, Total Loss: 0.2313, loss_single: 0.2292, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.182 sec

Iter: 20, obja.requires_grad = True
Iter: 20, objp.requires_grad = True
Iter: 20, obj_tilts.requires_grad = False
Iter: 20, probe.requires_grad = True
Iter: 20, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 20, relative pmode power = [0.246 0.107 0.106 0.098 0.076 0.075 0.061 0.059 0.058 0.043 0.039 0.032], probe int sum = 459.1867
Apply fix probe int constraint at iter 20, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 20
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 20
Apply z-direction Gaussian blur with std = 1 px on obja at iter 20
Apply z-direction Gaussian blur with std = 1 px on objp at iter 20
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 20
Apply hard positivity constraint on objp at iter 20
Iter: 20, Total Loss: 0.2312, loss_single: 0.2291, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.190 sec

Saving summary figures for iter 20

### Finished 100 iterations, averaged iter_t = 22.3 sec ###
Iter: 21, obja.requires_grad = True
Iter: 21, objp.requires_grad = True
Iter: 21, obj_tilts.requires_grad = False
Iter: 21, probe.requires_grad = True
Iter: 21, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.180 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.174 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 21, relative pmode power = [0.244 0.108 0.107 0.099 0.077 0.074 0.06  0.059 0.058 0.043 0.039 0.032], probe int sum = 463.7406
Apply fix probe int constraint at iter 21, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 21
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 21
Apply z-direction Gaussian blur with std = 1 px on obja at iter 21
Apply z-direction Gaussian blur with std = 1 px on objp at iter 21
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 21
Apply hard positivity constraint on objp at iter 21
Iter: 21, Total Loss: 0.2305, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.191 sec

Iter: 22, obja.requires_grad = True
Iter: 22, objp.requires_grad = True
Iter: 22, obj_tilts.requires_grad = False
Iter: 22, probe.requires_grad = True
Iter: 22, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 22, relative pmode power = [0.24  0.109 0.107 0.099 0.078 0.075 0.061 0.058 0.057 0.044 0.038 0.034], probe int sum = 466.9537
Apply fix probe int constraint at iter 22, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 22
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 22
Apply z-direction Gaussian blur with std = 1 px on obja at iter 22
Apply z-direction Gaussian blur with std = 1 px on objp at iter 22
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 22
Apply hard positivity constraint on objp at iter 22
Iter: 22, Total Loss: 0.2303, loss_single: 0.2281, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0021, loss_simlar: 0.0000, in 22.131 sec

Iter: 23, obja.requires_grad = True
Iter: 23, objp.requires_grad = True
Iter: 23, obj_tilts.requires_grad = False
Iter: 23, probe.requires_grad = True
Iter: 23, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 23, relative pmode power = [0.235 0.109 0.107 0.099 0.078 0.075 0.062 0.057 0.057 0.044 0.039 0.037], probe int sum = 470.5151
Apply fix probe int constraint at iter 23, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 23
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 23
Apply z-direction Gaussian blur with std = 1 px on obja at iter 23
Apply z-direction Gaussian blur with std = 1 px on objp at iter 23
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 23
Apply hard positivity constraint on objp at iter 23
Iter: 23, Total Loss: 0.2303, loss_single: 0.2281, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.132 sec

Iter: 24, obja.requires_grad = True
Iter: 24, objp.requires_grad = True
Iter: 24, obj_tilts.requires_grad = False
Iter: 24, probe.requires_grad = True
Iter: 24, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 24, relative pmode power = [0.231 0.109 0.107 0.1   0.079 0.076 0.064 0.058 0.051 0.046 0.043 0.036], probe int sum = 471.0990
Apply fix probe int constraint at iter 24, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 24
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 24
Apply z-direction Gaussian blur with std = 1 px on obja at iter 24
Apply z-direction Gaussian blur with std = 1 px on objp at iter 24
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 24
Apply hard positivity constraint on objp at iter 24
Iter: 24, Total Loss: 0.2304, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.118 sec

Iter: 25, obja.requires_grad = True
Iter: 25, objp.requires_grad = True
Iter: 25, obj_tilts.requires_grad = False
Iter: 25, probe.requires_grad = True
Iter: 25, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 25, relative pmode power = [0.232 0.113 0.11  0.103 0.082 0.079 0.067 0.061 0.044 0.037 0.037 0.034], probe int sum = 460.4683
Apply fix probe int constraint at iter 25, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 25
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 25
Apply z-direction Gaussian blur with std = 1 px on obja at iter 25
Apply z-direction Gaussian blur with std = 1 px on objp at iter 25
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 25
Apply hard positivity constraint on objp at iter 25
Iter: 25, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.133 sec

Iter: 26, obja.requires_grad = True
Iter: 26, objp.requires_grad = True
Iter: 26, obj_tilts.requires_grad = False
Iter: 26, probe.requires_grad = True
Iter: 26, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 26, relative pmode power = [0.229 0.114 0.111 0.103 0.084 0.08  0.07  0.064 0.043 0.036 0.034 0.031], probe int sum = 465.9797
Apply fix probe int constraint at iter 26, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 26
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 26
Apply z-direction Gaussian blur with std = 1 px on obja at iter 26
Apply z-direction Gaussian blur with std = 1 px on objp at iter 26
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 26
Apply hard positivity constraint on objp at iter 26
Iter: 26, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.372 sec

Iter: 27, obja.requires_grad = True
Iter: 27, objp.requires_grad = True
Iter: 27, obj_tilts.requires_grad = False
Iter: 27, probe.requires_grad = True
Iter: 27, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 27, relative pmode power = [0.224 0.115 0.111 0.104 0.085 0.081 0.072 0.067 0.043 0.035 0.034 0.028], probe int sum = 470.0107
Apply fix probe int constraint at iter 27, probe int sum = 450.4552
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 27
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 27
Apply z-direction Gaussian blur with std = 1 px on obja at iter 27
Apply z-direction Gaussian blur with std = 1 px on objp at iter 27
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 27
Apply hard positivity constraint on objp at iter 27
Iter: 27, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.237 sec

Iter: 28, obja.requires_grad = True
Iter: 28, objp.requires_grad = True
Iter: 28, obj_tilts.requires_grad = False
Iter: 28, probe.requires_grad = True
Iter: 28, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 28, relative pmode power = [0.219 0.115 0.11  0.104 0.087 0.082 0.074 0.07  0.043 0.035 0.033 0.027], probe int sum = 472.3920
Apply fix probe int constraint at iter 28, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 28
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 28
Apply z-direction Gaussian blur with std = 1 px on obja at iter 28
Apply z-direction Gaussian blur with std = 1 px on objp at iter 28
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 28
Apply hard positivity constraint on objp at iter 28
Iter: 28, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.103 sec

Iter: 29, obja.requires_grad = True
Iter: 29, objp.requires_grad = True
Iter: 29, obj_tilts.requires_grad = False
Iter: 29, probe.requires_grad = True
Iter: 29, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 29, relative pmode power = [0.213 0.115 0.11  0.104 0.087 0.083 0.076 0.073 0.044 0.035 0.033 0.027], probe int sum = 476.0580
Apply fix probe int constraint at iter 29, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 29
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 29
Apply z-direction Gaussian blur with std = 1 px on obja at iter 29
Apply z-direction Gaussian blur with std = 1 px on objp at iter 29
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 29
Apply hard positivity constraint on objp at iter 29
Iter: 29, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.101 sec

Iter: 30, obja.requires_grad = True
Iter: 30, objp.requires_grad = True
Iter: 30, obj_tilts.requires_grad = False
Iter: 30, probe.requires_grad = True
Iter: 30, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 30, relative pmode power = [0.207 0.115 0.108 0.104 0.087 0.083 0.077 0.076 0.044 0.037 0.032 0.03 ], probe int sum = 480.6734
Apply fix probe int constraint at iter 30, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 30
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 30
Apply z-direction Gaussian blur with std = 1 px on obja at iter 30
Apply z-direction Gaussian blur with std = 1 px on objp at iter 30
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 30
Apply hard positivity constraint on objp at iter 30
Iter: 30, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.106 sec

Saving summary figures for iter 30

### Finished 100 iterations, averaged iter_t = 22.3 sec ###
Iter: 31, obja.requires_grad = True
Iter: 31, objp.requires_grad = True
Iter: 31, obj_tilts.requires_grad = False
Iter: 31, probe.requires_grad = True
Iter: 31, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.178 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 31, relative pmode power = [0.199 0.114 0.107 0.103 0.087 0.083 0.077 0.077 0.046 0.04  0.036 0.03 ], probe int sum = 486.2548
Apply fix probe int constraint at iter 31, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 31
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 31
Apply z-direction Gaussian blur with std = 1 px on obja at iter 31
Apply z-direction Gaussian blur with std = 1 px on objp at iter 31
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 31
Apply hard positivity constraint on objp at iter 31
Iter: 31, Total Loss: 0.2307, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.121 sec

Iter: 32, obja.requires_grad = True
Iter: 32, objp.requires_grad = True
Iter: 32, obj_tilts.requires_grad = False
Iter: 32, probe.requires_grad = True
Iter: 32, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 32, relative pmode power = [0.19  0.113 0.105 0.102 0.087 0.083 0.078 0.078 0.046 0.046 0.043 0.029], probe int sum = 492.9346
Apply fix probe int constraint at iter 32, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 32
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 32
Apply z-direction Gaussian blur with std = 1 px on obja at iter 32
Apply z-direction Gaussian blur with std = 1 px on objp at iter 32
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 32
Apply hard positivity constraint on objp at iter 32
Iter: 32, Total Loss: 0.2308, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.098 sec

Iter: 33, obja.requires_grad = True
Iter: 33, objp.requires_grad = True
Iter: 33, obj_tilts.requires_grad = False
Iter: 33, probe.requires_grad = True
Iter: 33, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 33, relative pmode power = [0.181 0.111 0.103 0.101 0.086 0.083 0.079 0.077 0.057 0.047 0.046 0.028], probe int sum = 499.8322
Apply fix probe int constraint at iter 33, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 33
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 33
Apply z-direction Gaussian blur with std = 1 px on obja at iter 33
Apply z-direction Gaussian blur with std = 1 px on objp at iter 33
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 33
Apply hard positivity constraint on objp at iter 33
Iter: 33, Total Loss: 0.2310, loss_single: 0.2288, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.091 sec

Iter: 34, obja.requires_grad = True
Iter: 34, objp.requires_grad = True
Iter: 34, obj_tilts.requires_grad = False
Iter: 34, probe.requires_grad = True
Iter: 34, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 34, relative pmode power = [0.181 0.116 0.108 0.105 0.09  0.087 0.084 0.081 0.045 0.043 0.033 0.027], probe int sum = 481.4815
Apply fix probe int constraint at iter 34, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 34
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 34
Apply z-direction Gaussian blur with std = 1 px on obja at iter 34
Apply z-direction Gaussian blur with std = 1 px on objp at iter 34
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 34
Apply hard positivity constraint on objp at iter 34
Iter: 34, Total Loss: 0.2314, loss_single: 0.2292, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.101 sec

Iter: 35, obja.requires_grad = True
Iter: 35, objp.requires_grad = True
Iter: 35, obj_tilts.requires_grad = False
Iter: 35, probe.requires_grad = True
Iter: 35, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 35, relative pmode power = [0.18  0.118 0.11  0.107 0.091 0.089 0.088 0.084 0.046 0.036 0.027 0.024], probe int sum = 475.9295
Apply fix probe int constraint at iter 35, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 35
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 35
Apply z-direction Gaussian blur with std = 1 px on obja at iter 35
Apply z-direction Gaussian blur with std = 1 px on objp at iter 35
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 35
Apply hard positivity constraint on objp at iter 35
Iter: 35, Total Loss: 0.2308, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.112 sec

Iter: 36, obja.requires_grad = True
Iter: 36, objp.requires_grad = True
Iter: 36, obj_tilts.requires_grad = False
Iter: 36, probe.requires_grad = True
Iter: 36, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 36, relative pmode power = [0.177 0.119 0.11  0.107 0.092 0.091 0.091 0.088 0.048 0.031 0.026 0.019], probe int sum = 478.5537
Apply fix probe int constraint at iter 36, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 36
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 36
Apply z-direction Gaussian blur with std = 1 px on obja at iter 36
Apply z-direction Gaussian blur with std = 1 px on objp at iter 36
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 36
Apply hard positivity constraint on objp at iter 36
Iter: 36, Total Loss: 0.2307, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.107 sec

Iter: 37, obja.requires_grad = True
Iter: 37, objp.requires_grad = True
Iter: 37, obj_tilts.requires_grad = False
Iter: 37, probe.requires_grad = True
Iter: 37, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 37, relative pmode power = [0.172 0.118 0.11  0.106 0.095 0.094 0.092 0.092 0.05  0.028 0.026 0.017], probe int sum = 486.9755
Apply fix probe int constraint at iter 37, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 37
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 37
Apply z-direction Gaussian blur with std = 1 px on obja at iter 37
Apply z-direction Gaussian blur with std = 1 px on objp at iter 37
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 37
Apply hard positivity constraint on objp at iter 37
Iter: 37, Total Loss: 0.2308, loss_single: 0.2287, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.119 sec

Iter: 38, obja.requires_grad = True
Iter: 38, objp.requires_grad = True
Iter: 38, obj_tilts.requires_grad = False
Iter: 38, probe.requires_grad = True
Iter: 38, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 38, relative pmode power = [0.165 0.116 0.108 0.104 0.103 0.1   0.093 0.091 0.051 0.027 0.026 0.015], probe int sum = 499.0343
Apply fix probe int constraint at iter 38, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 38
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 38
Apply z-direction Gaussian blur with std = 1 px on obja at iter 38
Apply z-direction Gaussian blur with std = 1 px on objp at iter 38
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 38
Apply hard positivity constraint on objp at iter 38
Iter: 38, Total Loss: 0.2311, loss_single: 0.2289, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.135 sec

Iter: 39, obja.requires_grad = True
Iter: 39, objp.requires_grad = True
Iter: 39, obj_tilts.requires_grad = False
Iter: 39, probe.requires_grad = True
Iter: 39, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 39, relative pmode power = [0.155 0.116 0.113 0.111 0.106 0.101 0.092 0.089 0.053 0.026 0.025 0.014], probe int sum = 520.7356
Apply fix probe int constraint at iter 39, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 39
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 39
Apply z-direction Gaussian blur with std = 1 px on obja at iter 39
Apply z-direction Gaussian blur with std = 1 px on objp at iter 39
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 39
Apply hard positivity constraint on objp at iter 39
Iter: 39, Total Loss: 0.2317, loss_single: 0.2295, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.122 sec

Iter: 40, obja.requires_grad = True
Iter: 40, objp.requires_grad = True
Iter: 40, obj_tilts.requires_grad = False
Iter: 40, probe.requires_grad = True
Iter: 40, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 40, relative pmode power = [0.169 0.131 0.122 0.116 0.107 0.102 0.062 0.059 0.056 0.033 0.028 0.015], probe int sum = 461.8915
Apply fix probe int constraint at iter 40, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 40
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 40
Apply z-direction Gaussian blur with std = 1 px on obja at iter 40
Apply z-direction Gaussian blur with std = 1 px on objp at iter 40
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 40
Apply hard positivity constraint on objp at iter 40
Iter: 40, Total Loss: 0.2327, loss_single: 0.2305, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.105 sec

Saving summary figures for iter 40

### Finished 100 iterations, averaged iter_t = 22.2 sec ###
Iter: 41, obja.requires_grad = True
Iter: 41, objp.requires_grad = True
Iter: 41, obj_tilts.requires_grad = False
Iter: 41, probe.requires_grad = True
Iter: 41, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.179 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 41, relative pmode power = [0.16  0.125 0.118 0.11  0.103 0.1   0.077 0.071 0.064 0.034 0.025 0.013], probe int sum = 489.6679
Apply fix probe int constraint at iter 41, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 41
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 41
Apply z-direction Gaussian blur with std = 1 px on obja at iter 41
Apply z-direction Gaussian blur with std = 1 px on objp at iter 41
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 41
Apply hard positivity constraint on objp at iter 41
Iter: 41, Total Loss: 0.2320, loss_single: 0.2298, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.123 sec

Iter: 42, obja.requires_grad = True
Iter: 42, objp.requires_grad = True
Iter: 42, obj_tilts.requires_grad = False
Iter: 42, probe.requires_grad = True
Iter: 42, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 42, relative pmode power = [0.16  0.126 0.119 0.111 0.104 0.101 0.078 0.065 0.062 0.035 0.025 0.013], probe int sum = 475.2441
Apply fix probe int constraint at iter 42, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 42
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 42
Apply z-direction Gaussian blur with std = 1 px on obja at iter 42
Apply z-direction Gaussian blur with std = 1 px on objp at iter 42
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 42
Apply hard positivity constraint on objp at iter 42
Iter: 42, Total Loss: 0.2308, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.128 sec

Iter: 43, obja.requires_grad = True
Iter: 43, objp.requires_grad = True
Iter: 43, obj_tilts.requires_grad = False
Iter: 43, probe.requires_grad = True
Iter: 43, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 43, relative pmode power = [0.159 0.126 0.119 0.111 0.104 0.1   0.081 0.064 0.061 0.036 0.026 0.013], probe int sum = 473.0446
Apply fix probe int constraint at iter 43, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 43
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 43
Apply z-direction Gaussian blur with std = 1 px on obja at iter 43
Apply z-direction Gaussian blur with std = 1 px on objp at iter 43
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 43
Apply hard positivity constraint on objp at iter 43
Iter: 43, Total Loss: 0.2303, loss_single: 0.2281, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.134 sec

Iter: 44, obja.requires_grad = True
Iter: 44, objp.requires_grad = True
Iter: 44, obj_tilts.requires_grad = False
Iter: 44, probe.requires_grad = True
Iter: 44, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.174 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 44, relative pmode power = [0.158 0.126 0.119 0.111 0.105 0.1   0.084 0.061 0.059 0.036 0.028 0.013], probe int sum = 472.2765
Apply fix probe int constraint at iter 44, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 44
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 44
Apply z-direction Gaussian blur with std = 1 px on obja at iter 44
Apply z-direction Gaussian blur with std = 1 px on objp at iter 44
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 44
Apply hard positivity constraint on objp at iter 44
Iter: 44, Total Loss: 0.2302, loss_single: 0.2280, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.137 sec

Iter: 45, obja.requires_grad = True
Iter: 45, objp.requires_grad = True
Iter: 45, obj_tilts.requires_grad = False
Iter: 45, probe.requires_grad = True
Iter: 45, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 45, relative pmode power = [0.157 0.126 0.119 0.112 0.105 0.1   0.085 0.059 0.057 0.036 0.03  0.013], probe int sum = 472.3735
Apply fix probe int constraint at iter 45, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 45
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 45
Apply z-direction Gaussian blur with std = 1 px on obja at iter 45
Apply z-direction Gaussian blur with std = 1 px on objp at iter 45
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 45
Apply hard positivity constraint on objp at iter 45
Iter: 45, Total Loss: 0.2302, loss_single: 0.2280, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.108 sec

Iter: 46, obja.requires_grad = True
Iter: 46, objp.requires_grad = True
Iter: 46, obj_tilts.requires_grad = False
Iter: 46, probe.requires_grad = True
Iter: 46, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 46, relative pmode power = [0.156 0.126 0.119 0.112 0.105 0.101 0.087 0.057 0.056 0.034 0.033 0.013], probe int sum = 472.2875
Apply fix probe int constraint at iter 46, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 46
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 46
Apply z-direction Gaussian blur with std = 1 px on obja at iter 46
Apply z-direction Gaussian blur with std = 1 px on objp at iter 46
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 46
Apply hard positivity constraint on objp at iter 46
Iter: 46, Total Loss: 0.2303, loss_single: 0.2281, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.110 sec

Iter: 47, obja.requires_grad = True
Iter: 47, objp.requires_grad = True
Iter: 47, obj_tilts.requires_grad = False
Iter: 47, probe.requires_grad = True
Iter: 47, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.174 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 47, relative pmode power = [0.155 0.126 0.119 0.113 0.105 0.101 0.089 0.057 0.055 0.036 0.032 0.013], probe int sum = 472.6900
Apply fix probe int constraint at iter 47, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 47
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 47
Apply z-direction Gaussian blur with std = 1 px on obja at iter 47
Apply z-direction Gaussian blur with std = 1 px on objp at iter 47
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 47
Apply hard positivity constraint on objp at iter 47
Iter: 47, Total Loss: 0.2304, loss_single: 0.2282, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.102 sec

Iter: 48, obja.requires_grad = True
Iter: 48, objp.requires_grad = True
Iter: 48, obj_tilts.requires_grad = False
Iter: 48, probe.requires_grad = True
Iter: 48, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 48, relative pmode power = [0.154 0.126 0.12  0.113 0.106 0.101 0.09  0.057 0.055 0.036 0.027 0.013], probe int sum = 473.2859
Apply fix probe int constraint at iter 48, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 48
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 48
Apply z-direction Gaussian blur with std = 1 px on obja at iter 48
Apply z-direction Gaussian blur with std = 1 px on objp at iter 48
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 48
Apply hard positivity constraint on objp at iter 48
Iter: 48, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.100 sec

Iter: 49, obja.requires_grad = True
Iter: 49, objp.requires_grad = True
Iter: 49, obj_tilts.requires_grad = False
Iter: 49, probe.requires_grad = True
Iter: 49, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 49, relative pmode power = [0.153 0.126 0.12  0.114 0.107 0.102 0.091 0.06  0.057 0.036 0.023 0.013], probe int sum = 474.9624
Apply fix probe int constraint at iter 49, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 49
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 49
Apply z-direction Gaussian blur with std = 1 px on obja at iter 49
Apply z-direction Gaussian blur with std = 1 px on objp at iter 49
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 49
Apply hard positivity constraint on objp at iter 49
Iter: 49, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.104 sec

Iter: 50, obja.requires_grad = True
Iter: 50, objp.requires_grad = True
Iter: 50, obj_tilts.requires_grad = False
Iter: 50, probe.requires_grad = True
Iter: 50, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 50, relative pmode power = [0.151 0.125 0.119 0.113 0.107 0.102 0.092 0.064 0.059 0.034 0.02  0.013], probe int sum = 478.3900
Apply fix probe int constraint at iter 50, probe int sum = 450.4552
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 50
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 50
Apply z-direction Gaussian blur with std = 1 px on obja at iter 50
Apply z-direction Gaussian blur with std = 1 px on objp at iter 50
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 50
Apply hard positivity constraint on objp at iter 50
Iter: 50, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.102 sec

Saving summary figures for iter 50

### Finished 100 iterations, averaged iter_t = 22.2 sec ###
Iter: 51, obja.requires_grad = True
Iter: 51, objp.requires_grad = True
Iter: 51, obj_tilts.requires_grad = False
Iter: 51, probe.requires_grad = True
Iter: 51, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.180 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 51, relative pmode power = [0.149 0.124 0.118 0.113 0.107 0.103 0.092 0.069 0.061 0.033 0.018 0.013], probe int sum = 480.8776
Apply fix probe int constraint at iter 51, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 51
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 51
Apply z-direction Gaussian blur with std = 1 px on obja at iter 51
Apply z-direction Gaussian blur with std = 1 px on objp at iter 51
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 51
Apply hard positivity constraint on objp at iter 51
Iter: 51, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.108 sec

Iter: 52, obja.requires_grad = True
Iter: 52, objp.requires_grad = True
Iter: 52, obj_tilts.requires_grad = False
Iter: 52, probe.requires_grad = True
Iter: 52, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 52, relative pmode power = [0.147 0.124 0.117 0.113 0.108 0.103 0.093 0.074 0.061 0.031 0.017 0.013], probe int sum = 479.2255
Apply fix probe int constraint at iter 52, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 52
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 52
Apply z-direction Gaussian blur with std = 1 px on obja at iter 52
Apply z-direction Gaussian blur with std = 1 px on objp at iter 52
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 52
Apply hard positivity constraint on objp at iter 52
Iter: 52, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.106 sec

Iter: 53, obja.requires_grad = True
Iter: 53, objp.requires_grad = True
Iter: 53, obj_tilts.requires_grad = False
Iter: 53, probe.requires_grad = True
Iter: 53, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 53, relative pmode power = [0.145 0.124 0.117 0.113 0.109 0.104 0.094 0.078 0.059 0.028 0.016 0.013], probe int sum = 478.0175
Apply fix probe int constraint at iter 53, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 53
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 53
Apply z-direction Gaussian blur with std = 1 px on obja at iter 53
Apply z-direction Gaussian blur with std = 1 px on objp at iter 53
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 53
Apply hard positivity constraint on objp at iter 53
Iter: 53, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.114 sec

Iter: 54, obja.requires_grad = True
Iter: 54, objp.requires_grad = True
Iter: 54, obj_tilts.requires_grad = False
Iter: 54, probe.requires_grad = True
Iter: 54, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 54, relative pmode power = [0.144 0.123 0.117 0.113 0.109 0.104 0.094 0.081 0.059 0.026 0.016 0.013], probe int sum = 477.7997
Apply fix probe int constraint at iter 54, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 54
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 54
Apply z-direction Gaussian blur with std = 1 px on obja at iter 54
Apply z-direction Gaussian blur with std = 1 px on objp at iter 54
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 54
Apply hard positivity constraint on objp at iter 54
Iter: 54, Total Loss: 0.2305, loss_single: 0.2282, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.115 sec

Iter: 55, obja.requires_grad = True
Iter: 55, objp.requires_grad = True
Iter: 55, obj_tilts.requires_grad = False
Iter: 55, probe.requires_grad = True
Iter: 55, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 55, relative pmode power = [0.143 0.123 0.116 0.113 0.11  0.105 0.094 0.083 0.06  0.025 0.016 0.013], probe int sum = 478.4283
Apply fix probe int constraint at iter 55, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 55
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 55
Apply z-direction Gaussian blur with std = 1 px on obja at iter 55
Apply z-direction Gaussian blur with std = 1 px on objp at iter 55
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 55
Apply hard positivity constraint on objp at iter 55
Iter: 55, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.122 sec

Iter: 56, obja.requires_grad = True
Iter: 56, objp.requires_grad = True
Iter: 56, obj_tilts.requires_grad = False
Iter: 56, probe.requires_grad = True
Iter: 56, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 56, relative pmode power = [0.141 0.123 0.116 0.113 0.11  0.105 0.095 0.084 0.061 0.024 0.016 0.013], probe int sum = 478.5095
Apply fix probe int constraint at iter 56, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 56
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 56
Apply z-direction Gaussian blur with std = 1 px on obja at iter 56
Apply z-direction Gaussian blur with std = 1 px on objp at iter 56
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 56
Apply hard positivity constraint on objp at iter 56
Iter: 56, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.131 sec

Iter: 57, obja.requires_grad = True
Iter: 57, objp.requires_grad = True
Iter: 57, obj_tilts.requires_grad = False
Iter: 57, probe.requires_grad = True
Iter: 57, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 57, relative pmode power = [0.14  0.123 0.115 0.114 0.11  0.105 0.095 0.085 0.061 0.023 0.015 0.013], probe int sum = 478.0596
Apply fix probe int constraint at iter 57, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 57
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 57
Apply z-direction Gaussian blur with std = 1 px on obja at iter 57
Apply z-direction Gaussian blur with std = 1 px on objp at iter 57
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 57
Apply hard positivity constraint on objp at iter 57
Iter: 57, Total Loss: 0.2306, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.118 sec

Iter: 58, obja.requires_grad = True
Iter: 58, objp.requires_grad = True
Iter: 58, obj_tilts.requires_grad = False
Iter: 58, probe.requires_grad = True
Iter: 58, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 58, relative pmode power = [0.139 0.122 0.115 0.114 0.111 0.105 0.095 0.086 0.063 0.022 0.015 0.013], probe int sum = 479.3226
Apply fix probe int constraint at iter 58, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 58
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 58
Apply z-direction Gaussian blur with std = 1 px on obja at iter 58
Apply z-direction Gaussian blur with std = 1 px on objp at iter 58
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 58
Apply hard positivity constraint on objp at iter 58
Iter: 58, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.112 sec

Iter: 59, obja.requires_grad = True
Iter: 59, objp.requires_grad = True
Iter: 59, obj_tilts.requires_grad = False
Iter: 59, probe.requires_grad = True
Iter: 59, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 59, relative pmode power = [0.137 0.122 0.115 0.114 0.111 0.105 0.096 0.087 0.064 0.021 0.016 0.013], probe int sum = 479.8013
Apply fix probe int constraint at iter 59, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 59
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 59
Apply z-direction Gaussian blur with std = 1 px on obja at iter 59
Apply z-direction Gaussian blur with std = 1 px on objp at iter 59
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 59
Apply hard positivity constraint on objp at iter 59
Iter: 59, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.115 sec

Iter: 60, obja.requires_grad = True
Iter: 60, objp.requires_grad = True
Iter: 60, obj_tilts.requires_grad = False
Iter: 60, probe.requires_grad = True
Iter: 60, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 60, relative pmode power = [0.136 0.122 0.114 0.114 0.111 0.106 0.096 0.088 0.065 0.02  0.016 0.013], probe int sum = 479.9518
Apply fix probe int constraint at iter 60, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 60
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 60
Apply z-direction Gaussian blur with std = 1 px on obja at iter 60
Apply z-direction Gaussian blur with std = 1 px on objp at iter 60
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 60
Apply hard positivity constraint on objp at iter 60
Iter: 60, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.109 sec

Saving summary figures for iter 60

### Finished 100 iterations, averaged iter_t = 22.2 sec ###
Iter: 61, obja.requires_grad = True
Iter: 61, objp.requires_grad = True
Iter: 61, obj_tilts.requires_grad = False
Iter: 61, probe.requires_grad = True
Iter: 61, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.177 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 61, relative pmode power = [0.135 0.121 0.114 0.114 0.111 0.105 0.096 0.088 0.066 0.02  0.016 0.014], probe int sum = 481.1558
Apply fix probe int constraint at iter 61, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 61
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 61
Apply z-direction Gaussian blur with std = 1 px on obja at iter 61
Apply z-direction Gaussian blur with std = 1 px on objp at iter 61
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 61
Apply hard positivity constraint on objp at iter 61
Iter: 61, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.138 sec

Iter: 62, obja.requires_grad = True
Iter: 62, objp.requires_grad = True
Iter: 62, obj_tilts.requires_grad = False
Iter: 62, probe.requires_grad = True
Iter: 62, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.174 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 62, relative pmode power = [0.133 0.121 0.114 0.114 0.111 0.106 0.097 0.088 0.067 0.019 0.016 0.014], probe int sum = 481.8350
Apply fix probe int constraint at iter 62, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 62
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 62
Apply z-direction Gaussian blur with std = 1 px on obja at iter 62
Apply z-direction Gaussian blur with std = 1 px on objp at iter 62
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 62
Apply hard positivity constraint on objp at iter 62
Iter: 62, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.127 sec

Iter: 63, obja.requires_grad = True
Iter: 63, objp.requires_grad = True
Iter: 63, obj_tilts.requires_grad = False
Iter: 63, probe.requires_grad = True
Iter: 63, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 63, relative pmode power = [0.132 0.121 0.114 0.114 0.111 0.105 0.097 0.089 0.068 0.019 0.016 0.014], probe int sum = 482.2712
Apply fix probe int constraint at iter 63, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 63
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 63
Apply z-direction Gaussian blur with std = 1 px on obja at iter 63
Apply z-direction Gaussian blur with std = 1 px on objp at iter 63
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 63
Apply hard positivity constraint on objp at iter 63
Iter: 63, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.129 sec

Iter: 64, obja.requires_grad = True
Iter: 64, objp.requires_grad = True
Iter: 64, obj_tilts.requires_grad = False
Iter: 64, probe.requires_grad = True
Iter: 64, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 64, relative pmode power = [0.131 0.12  0.115 0.114 0.111 0.105 0.098 0.089 0.069 0.019 0.016 0.014], probe int sum = 482.7379
Apply fix probe int constraint at iter 64, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 64
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 64
Apply z-direction Gaussian blur with std = 1 px on obja at iter 64
Apply z-direction Gaussian blur with std = 1 px on objp at iter 64
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 64
Apply hard positivity constraint on objp at iter 64
Iter: 64, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.129 sec

Iter: 65, obja.requires_grad = True
Iter: 65, objp.requires_grad = True
Iter: 65, obj_tilts.requires_grad = False
Iter: 65, probe.requires_grad = True
Iter: 65, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 65, relative pmode power = [0.129 0.12  0.115 0.114 0.111 0.105 0.098 0.089 0.07  0.019 0.016 0.013], probe int sum = 482.9423
Apply fix probe int constraint at iter 65, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 65
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 65
Apply z-direction Gaussian blur with std = 1 px on obja at iter 65
Apply z-direction Gaussian blur with std = 1 px on objp at iter 65
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 65
Apply hard positivity constraint on objp at iter 65
Iter: 65, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.130 sec

Iter: 66, obja.requires_grad = True
Iter: 66, objp.requires_grad = True
Iter: 66, obj_tilts.requires_grad = False
Iter: 66, probe.requires_grad = True
Iter: 66, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.174 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 66, relative pmode power = [0.128 0.119 0.115 0.114 0.111 0.105 0.098 0.09  0.071 0.02  0.016 0.013], probe int sum = 483.2710
Apply fix probe int constraint at iter 66, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 66
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 66
Apply z-direction Gaussian blur with std = 1 px on obja at iter 66
Apply z-direction Gaussian blur with std = 1 px on objp at iter 66
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 66
Apply hard positivity constraint on objp at iter 66
Iter: 66, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.129 sec

Iter: 67, obja.requires_grad = True
Iter: 67, objp.requires_grad = True
Iter: 67, obj_tilts.requires_grad = False
Iter: 67, probe.requires_grad = True
Iter: 67, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 67, relative pmode power = [0.127 0.119 0.115 0.113 0.111 0.105 0.098 0.09  0.072 0.02  0.016 0.013], probe int sum = 484.3318
Apply fix probe int constraint at iter 67, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 67
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 67
Apply z-direction Gaussian blur with std = 1 px on obja at iter 67
Apply z-direction Gaussian blur with std = 1 px on objp at iter 67
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 67
Apply hard positivity constraint on objp at iter 67
Iter: 67, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.127 sec

Iter: 68, obja.requires_grad = True
Iter: 68, objp.requires_grad = True
Iter: 68, obj_tilts.requires_grad = False
Iter: 68, probe.requires_grad = True
Iter: 68, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 68, relative pmode power = [0.126 0.119 0.115 0.113 0.111 0.105 0.099 0.09  0.072 0.021 0.016 0.013], probe int sum = 484.9894
Apply fix probe int constraint at iter 68, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 68
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 68
Apply z-direction Gaussian blur with std = 1 px on obja at iter 68
Apply z-direction Gaussian blur with std = 1 px on objp at iter 68
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 68
Apply hard positivity constraint on objp at iter 68
Iter: 68, Total Loss: 0.2306, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.123 sec

Iter: 69, obja.requires_grad = True
Iter: 69, objp.requires_grad = True
Iter: 69, obj_tilts.requires_grad = False
Iter: 69, probe.requires_grad = True
Iter: 69, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.174 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 69, relative pmode power = [0.125 0.118 0.115 0.112 0.11  0.105 0.099 0.091 0.073 0.023 0.017 0.013], probe int sum = 485.9280
Apply fix probe int constraint at iter 69, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 69
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 69
Apply z-direction Gaussian blur with std = 1 px on obja at iter 69
Apply z-direction Gaussian blur with std = 1 px on objp at iter 69
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 69
Apply hard positivity constraint on objp at iter 69
Iter: 69, Total Loss: 0.2306, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.149 sec

Iter: 70, obja.requires_grad = True
Iter: 70, objp.requires_grad = True
Iter: 70, obj_tilts.requires_grad = False
Iter: 70, probe.requires_grad = True
Iter: 70, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 70, relative pmode power = [0.124 0.117 0.115 0.112 0.11  0.105 0.098 0.091 0.073 0.025 0.017 0.013], probe int sum = 487.9596
Apply fix probe int constraint at iter 70, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 70
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 70
Apply z-direction Gaussian blur with std = 1 px on obja at iter 70
Apply z-direction Gaussian blur with std = 1 px on objp at iter 70
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 70
Apply hard positivity constraint on objp at iter 70
Iter: 70, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.137 sec

Saving summary figures for iter 70

### Finished 100 iterations, averaged iter_t = 22.2 sec ###
Iter: 71, obja.requires_grad = True
Iter: 71, objp.requires_grad = True
Iter: 71, obj_tilts.requires_grad = False
Iter: 71, probe.requires_grad = True
Iter: 71, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.178 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 71, relative pmode power = [0.122 0.116 0.115 0.111 0.109 0.105 0.098 0.091 0.072 0.029 0.018 0.013], probe int sum = 489.8510
Apply fix probe int constraint at iter 71, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 71
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 71
Apply z-direction Gaussian blur with std = 1 px on obja at iter 71
Apply z-direction Gaussian blur with std = 1 px on objp at iter 71
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 71
Apply hard positivity constraint on objp at iter 71
Iter: 71, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.119 sec

Iter: 72, obja.requires_grad = True
Iter: 72, objp.requires_grad = True
Iter: 72, obj_tilts.requires_grad = False
Iter: 72, probe.requires_grad = True
Iter: 72, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 72, relative pmode power = [0.121 0.116 0.114 0.11  0.108 0.104 0.098 0.091 0.069 0.036 0.019 0.013], probe int sum = 492.1137
Apply fix probe int constraint at iter 72, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 72
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 72
Apply z-direction Gaussian blur with std = 1 px on obja at iter 72
Apply z-direction Gaussian blur with std = 1 px on objp at iter 72
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 72
Apply hard positivity constraint on objp at iter 72
Iter: 72, Total Loss: 0.2307, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.120 sec

Iter: 73, obja.requires_grad = True
Iter: 73, objp.requires_grad = True
Iter: 73, obj_tilts.requires_grad = False
Iter: 73, probe.requires_grad = True
Iter: 73, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 73, relative pmode power = [0.12  0.115 0.115 0.111 0.108 0.105 0.098 0.091 0.056 0.046 0.02  0.014], probe int sum = 491.2268
Apply fix probe int constraint at iter 73, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 73
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 73
Apply z-direction Gaussian blur with std = 1 px on obja at iter 73
Apply z-direction Gaussian blur with std = 1 px on objp at iter 73
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 73
Apply hard positivity constraint on objp at iter 73
Iter: 73, Total Loss: 0.2309, loss_single: 0.2287, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.129 sec

Iter: 74, obja.requires_grad = True
Iter: 74, objp.requires_grad = True
Iter: 74, obj_tilts.requires_grad = False
Iter: 74, probe.requires_grad = True
Iter: 74, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 74, relative pmode power = [0.121 0.116 0.116 0.111 0.109 0.106 0.099 0.092 0.047 0.047 0.022 0.014], probe int sum = 487.8658
Apply fix probe int constraint at iter 74, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 74
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 74
Apply z-direction Gaussian blur with std = 1 px on obja at iter 74
Apply z-direction Gaussian blur with std = 1 px on objp at iter 74
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 74
Apply hard positivity constraint on objp at iter 74
Iter: 74, Total Loss: 0.2309, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.144 sec

Iter: 75, obja.requires_grad = True
Iter: 75, objp.requires_grad = True
Iter: 75, obj_tilts.requires_grad = False
Iter: 75, probe.requires_grad = True
Iter: 75, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 75, relative pmode power = [0.122 0.119 0.118 0.113 0.11  0.107 0.101 0.091 0.042 0.041 0.02  0.015], probe int sum = 483.3364
Apply fix probe int constraint at iter 75, probe int sum = 450.4552
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 75
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 75
Apply z-direction Gaussian blur with std = 1 px on obja at iter 75
Apply z-direction Gaussian blur with std = 1 px on objp at iter 75
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 75
Apply hard positivity constraint on objp at iter 75
Iter: 75, Total Loss: 0.2308, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.131 sec

Iter: 76, obja.requires_grad = True
Iter: 76, objp.requires_grad = True
Iter: 76, obj_tilts.requires_grad = False
Iter: 76, probe.requires_grad = True
Iter: 76, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 76, relative pmode power = [0.122 0.12  0.12  0.113 0.11  0.108 0.102 0.091 0.041 0.039 0.018 0.015], probe int sum = 483.1745
Apply fix probe int constraint at iter 76, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 76
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 76
Apply z-direction Gaussian blur with std = 1 px on obja at iter 76
Apply z-direction Gaussian blur with std = 1 px on objp at iter 76
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 76
Apply hard positivity constraint on objp at iter 76
Iter: 76, Total Loss: 0.2308, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.132 sec

Iter: 77, obja.requires_grad = True
Iter: 77, objp.requires_grad = True
Iter: 77, obj_tilts.requires_grad = False
Iter: 77, probe.requires_grad = True
Iter: 77, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 77, relative pmode power = [0.122 0.121 0.12  0.113 0.11  0.108 0.103 0.089 0.043 0.038 0.017 0.016], probe int sum = 484.0643
Apply fix probe int constraint at iter 77, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 77
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 77
Apply z-direction Gaussian blur with std = 1 px on obja at iter 77
Apply z-direction Gaussian blur with std = 1 px on objp at iter 77
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 77
Apply hard positivity constraint on objp at iter 77
Iter: 77, Total Loss: 0.2307, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.126 sec

Iter: 78, obja.requires_grad = True
Iter: 78, objp.requires_grad = True
Iter: 78, obj_tilts.requires_grad = False
Iter: 78, probe.requires_grad = True
Iter: 78, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.175 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 78, relative pmode power = [0.122 0.122 0.119 0.113 0.11  0.109 0.103 0.089 0.044 0.037 0.016 0.015], probe int sum = 482.4468
Apply fix probe int constraint at iter 78, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 78
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 78
Apply z-direction Gaussian blur with std = 1 px on obja at iter 78
Apply z-direction Gaussian blur with std = 1 px on objp at iter 78
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 78
Apply hard positivity constraint on objp at iter 78
Iter: 78, Total Loss: 0.2305, loss_single: 0.2282, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.130 sec

Iter: 79, obja.requires_grad = True
Iter: 79, objp.requires_grad = True
Iter: 79, obj_tilts.requires_grad = False
Iter: 79, probe.requires_grad = True
Iter: 79, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 79, relative pmode power = [0.122 0.122 0.119 0.112 0.109 0.109 0.104 0.088 0.048 0.036 0.016 0.016], probe int sum = 484.8069
Apply fix probe int constraint at iter 79, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 79
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 79
Apply z-direction Gaussian blur with std = 1 px on obja at iter 79
Apply z-direction Gaussian blur with std = 1 px on objp at iter 79
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 79
Apply hard positivity constraint on objp at iter 79
Iter: 79, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.124 sec

Iter: 80, obja.requires_grad = True
Iter: 80, objp.requires_grad = True
Iter: 80, obj_tilts.requires_grad = False
Iter: 80, probe.requires_grad = True
Iter: 80, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 80, relative pmode power = [0.123 0.122 0.118 0.111 0.109 0.108 0.104 0.088 0.051 0.034 0.016 0.016], probe int sum = 486.8475
Apply fix probe int constraint at iter 80, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 80
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 80
Apply z-direction Gaussian blur with std = 1 px on obja at iter 80
Apply z-direction Gaussian blur with std = 1 px on objp at iter 80
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 80
Apply hard positivity constraint on objp at iter 80
Iter: 80, Total Loss: 0.2306, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.132 sec

Saving summary figures for iter 80

### Finished 100 iterations, averaged iter_t = 22.2 sec ###
Iter: 81, obja.requires_grad = True
Iter: 81, objp.requires_grad = True
Iter: 81, obj_tilts.requires_grad = False
Iter: 81, probe.requires_grad = True
Iter: 81, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.180 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 81, relative pmode power = [0.122 0.121 0.117 0.11  0.109 0.108 0.104 0.088 0.055 0.035 0.016 0.016], probe int sum = 489.6154
Apply fix probe int constraint at iter 81, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 81
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 81
Apply z-direction Gaussian blur with std = 1 px on obja at iter 81
Apply z-direction Gaussian blur with std = 1 px on objp at iter 81
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 81
Apply hard positivity constraint on objp at iter 81
Iter: 81, Total Loss: 0.2308, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.123 sec

Iter: 82, obja.requires_grad = True
Iter: 82, objp.requires_grad = True
Iter: 82, obj_tilts.requires_grad = False
Iter: 82, probe.requires_grad = True
Iter: 82, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 82, relative pmode power = [0.121 0.121 0.115 0.109 0.108 0.106 0.103 0.087 0.067 0.032 0.016 0.016], probe int sum = 495.7534
Apply fix probe int constraint at iter 82, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 82
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 82
Apply z-direction Gaussian blur with std = 1 px on obja at iter 82
Apply z-direction Gaussian blur with std = 1 px on objp at iter 82
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 82
Apply hard positivity constraint on objp at iter 82
Iter: 82, Total Loss: 0.2309, loss_single: 0.2286, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.142 sec

Iter: 83, obja.requires_grad = True
Iter: 83, objp.requires_grad = True
Iter: 83, obj_tilts.requires_grad = False
Iter: 83, probe.requires_grad = True
Iter: 83, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 83, relative pmode power = [0.125 0.124 0.118 0.111 0.111 0.109 0.106 0.09  0.054 0.019 0.018 0.015], probe int sum = 481.4003
Apply fix probe int constraint at iter 83, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 83
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 83
Apply z-direction Gaussian blur with std = 1 px on obja at iter 83
Apply z-direction Gaussian blur with std = 1 px on objp at iter 83
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 83
Apply hard positivity constraint on objp at iter 83
Iter: 83, Total Loss: 0.2312, loss_single: 0.2289, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.130 sec

Iter: 84, obja.requires_grad = True
Iter: 84, objp.requires_grad = True
Iter: 84, obj_tilts.requires_grad = False
Iter: 84, probe.requires_grad = True
Iter: 84, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 84, relative pmode power = [0.124 0.123 0.117 0.11  0.11  0.108 0.105 0.089 0.06  0.019 0.018 0.016], probe int sum = 495.5419
Apply fix probe int constraint at iter 84, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 84
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 84
Apply z-direction Gaussian blur with std = 1 px on obja at iter 84
Apply z-direction Gaussian blur with std = 1 px on objp at iter 84
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 84
Apply hard positivity constraint on objp at iter 84
Iter: 84, Total Loss: 0.2314, loss_single: 0.2291, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.125 sec

Iter: 85, obja.requires_grad = True
Iter: 85, objp.requires_grad = True
Iter: 85, obj_tilts.requires_grad = False
Iter: 85, probe.requires_grad = True
Iter: 85, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 85, relative pmode power = [0.123 0.122 0.116 0.11  0.11  0.107 0.105 0.089 0.064 0.02  0.018 0.015], probe int sum = 491.2149
Apply fix probe int constraint at iter 85, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 85
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 85
Apply z-direction Gaussian blur with std = 1 px on obja at iter 85
Apply z-direction Gaussian blur with std = 1 px on objp at iter 85
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 85
Apply hard positivity constraint on objp at iter 85
Iter: 85, Total Loss: 0.2311, loss_single: 0.2288, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.132 sec

Iter: 86, obja.requires_grad = True
Iter: 86, objp.requires_grad = True
Iter: 86, obj_tilts.requires_grad = False
Iter: 86, probe.requires_grad = True
Iter: 86, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 86, relative pmode power = [0.124 0.122 0.115 0.11  0.11  0.107 0.105 0.089 0.067 0.019 0.017 0.016], probe int sum = 488.4559
Apply fix probe int constraint at iter 86, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 86
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 86
Apply z-direction Gaussian blur with std = 1 px on obja at iter 86
Apply z-direction Gaussian blur with std = 1 px on objp at iter 86
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 86
Apply hard positivity constraint on objp at iter 86
Iter: 86, Total Loss: 0.2308, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.117 sec

Iter: 87, obja.requires_grad = True
Iter: 87, objp.requires_grad = True
Iter: 87, obj_tilts.requires_grad = False
Iter: 87, probe.requires_grad = True
Iter: 87, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 87, relative pmode power = [0.123 0.122 0.115 0.11  0.11  0.107 0.105 0.089 0.069 0.018 0.016 0.016], probe int sum = 487.7220
Apply fix probe int constraint at iter 87, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 87
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 87
Apply z-direction Gaussian blur with std = 1 px on obja at iter 87
Apply z-direction Gaussian blur with std = 1 px on objp at iter 87
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 87
Apply hard positivity constraint on objp at iter 87
Iter: 87, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.109 sec

Iter: 88, obja.requires_grad = True
Iter: 88, objp.requires_grad = True
Iter: 88, obj_tilts.requires_grad = False
Iter: 88, probe.requires_grad = True
Iter: 88, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 88, relative pmode power = [0.123 0.121 0.114 0.11  0.11  0.106 0.105 0.089 0.07  0.018 0.017 0.016], probe int sum = 488.8761
Apply fix probe int constraint at iter 88, probe int sum = 450.4554
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 88
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 88
Apply z-direction Gaussian blur with std = 1 px on obja at iter 88
Apply z-direction Gaussian blur with std = 1 px on objp at iter 88
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 88
Apply hard positivity constraint on objp at iter 88
Iter: 88, Total Loss: 0.2307, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.127 sec

Iter: 89, obja.requires_grad = True
Iter: 89, objp.requires_grad = True
Iter: 89, obj_tilts.requires_grad = False
Iter: 89, probe.requires_grad = True
Iter: 89, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 89, relative pmode power = [0.123 0.12  0.113 0.111 0.11  0.106 0.106 0.089 0.072 0.018 0.017 0.016], probe int sum = 489.8960
Apply fix probe int constraint at iter 89, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 89
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 89
Apply z-direction Gaussian blur with std = 1 px on obja at iter 89
Apply z-direction Gaussian blur with std = 1 px on objp at iter 89
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 89
Apply hard positivity constraint on objp at iter 89
Iter: 89, Total Loss: 0.2307, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.139 sec

Iter: 90, obja.requires_grad = True
Iter: 90, objp.requires_grad = True
Iter: 90, obj_tilts.requires_grad = False
Iter: 90, probe.requires_grad = True
Iter: 90, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 90, relative pmode power = [0.122 0.12  0.113 0.11  0.11  0.106 0.105 0.089 0.073 0.018 0.017 0.015], probe int sum = 490.3505
Apply fix probe int constraint at iter 90, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 90
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 90
Apply z-direction Gaussian blur with std = 1 px on obja at iter 90
Apply z-direction Gaussian blur with std = 1 px on objp at iter 90
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 90
Apply hard positivity constraint on objp at iter 90
Iter: 90, Total Loss: 0.2307, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.136 sec

Saving summary figures for iter 90

### Finished 100 iterations, averaged iter_t = 22.2 sec ###
Iter: 91, obja.requires_grad = True
Iter: 91, objp.requires_grad = True
Iter: 91, obj_tilts.requires_grad = False
Iter: 91, probe.requires_grad = True
Iter: 91, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.179 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 91, relative pmode power = [0.122 0.119 0.112 0.111 0.109 0.107 0.106 0.089 0.074 0.018 0.017 0.015], probe int sum = 490.5884
Apply fix probe int constraint at iter 91, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 91
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 91
Apply z-direction Gaussian blur with std = 1 px on obja at iter 91
Apply z-direction Gaussian blur with std = 1 px on objp at iter 91
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 91
Apply hard positivity constraint on objp at iter 91
Iter: 91, Total Loss: 0.2308, loss_single: 0.2285, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.140 sec

Iter: 92, obja.requires_grad = True
Iter: 92, objp.requires_grad = True
Iter: 92, obj_tilts.requires_grad = False
Iter: 92, probe.requires_grad = True
Iter: 92, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 92, relative pmode power = [0.122 0.118 0.112 0.111 0.109 0.107 0.105 0.09  0.076 0.018 0.017 0.015], probe int sum = 488.9122
Apply fix probe int constraint at iter 92, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 92
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 92
Apply z-direction Gaussian blur with std = 1 px on obja at iter 92
Apply z-direction Gaussian blur with std = 1 px on objp at iter 92
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 92
Apply hard positivity constraint on objp at iter 92
Iter: 92, Total Loss: 0.2307, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.124 sec

Iter: 93, obja.requires_grad = True
Iter: 93, objp.requires_grad = True
Iter: 93, obj_tilts.requires_grad = False
Iter: 93, probe.requires_grad = True
Iter: 93, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 93, relative pmode power = [0.122 0.118 0.112 0.112 0.109 0.108 0.105 0.09  0.077 0.017 0.016 0.014], probe int sum = 487.1692
Apply fix probe int constraint at iter 93, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 93
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 93
Apply z-direction Gaussian blur with std = 1 px on obja at iter 93
Apply z-direction Gaussian blur with std = 1 px on objp at iter 93
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 93
Apply hard positivity constraint on objp at iter 93
Iter: 93, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.123 sec

Iter: 94, obja.requires_grad = True
Iter: 94, objp.requires_grad = True
Iter: 94, obj_tilts.requires_grad = False
Iter: 94, probe.requires_grad = True
Iter: 94, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.174 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 94, relative pmode power = [0.121 0.118 0.112 0.112 0.109 0.108 0.105 0.09  0.078 0.017 0.016 0.014], probe int sum = 487.9233
Apply fix probe int constraint at iter 94, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 94
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 94
Apply z-direction Gaussian blur with std = 1 px on obja at iter 94
Apply z-direction Gaussian blur with std = 1 px on objp at iter 94
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 94
Apply hard positivity constraint on objp at iter 94
Iter: 94, Total Loss: 0.2304, loss_single: 0.2282, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.131 sec

Iter: 95, obja.requires_grad = True
Iter: 95, objp.requires_grad = True
Iter: 95, obj_tilts.requires_grad = False
Iter: 95, probe.requires_grad = True
Iter: 95, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.173 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 95, relative pmode power = [0.121 0.117 0.113 0.112 0.109 0.109 0.104 0.091 0.079 0.017 0.015 0.014], probe int sum = 489.0221
Apply fix probe int constraint at iter 95, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 95
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 95
Apply z-direction Gaussian blur with std = 1 px on obja at iter 95
Apply z-direction Gaussian blur with std = 1 px on objp at iter 95
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 95
Apply hard positivity constraint on objp at iter 95
Iter: 95, Total Loss: 0.2305, loss_single: 0.2282, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.132 sec

Iter: 96, obja.requires_grad = True
Iter: 96, objp.requires_grad = True
Iter: 96, obj_tilts.requires_grad = False
Iter: 96, probe.requires_grad = True
Iter: 96, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 96, relative pmode power = [0.121 0.117 0.113 0.112 0.109 0.109 0.104 0.091 0.08  0.016 0.015 0.013], probe int sum = 489.5647
Apply fix probe int constraint at iter 96, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 96
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 96
Apply z-direction Gaussian blur with std = 1 px on obja at iter 96
Apply z-direction Gaussian blur with std = 1 px on objp at iter 96
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 96
Apply hard positivity constraint on objp at iter 96
Iter: 96, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.123 sec

Iter: 97, obja.requires_grad = True
Iter: 97, objp.requires_grad = True
Iter: 97, obj_tilts.requires_grad = False
Iter: 97, probe.requires_grad = True
Iter: 97, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.175 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 97, relative pmode power = [0.12  0.116 0.113 0.112 0.11  0.109 0.104 0.092 0.08  0.016 0.015 0.013], probe int sum = 489.4543
Apply fix probe int constraint at iter 97, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 97
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 97
Apply z-direction Gaussian blur with std = 1 px on obja at iter 97
Apply z-direction Gaussian blur with std = 1 px on objp at iter 97
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 97
Apply hard positivity constraint on objp at iter 97
Iter: 97, Total Loss: 0.2307, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.143 sec

Iter: 98, obja.requires_grad = True
Iter: 98, objp.requires_grad = True
Iter: 98, obj_tilts.requires_grad = False
Iter: 98, probe.requires_grad = True
Iter: 98, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 98, relative pmode power = [0.12  0.116 0.114 0.112 0.11  0.109 0.104 0.092 0.081 0.015 0.014 0.013], probe int sum = 489.0251
Apply fix probe int constraint at iter 98, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 98
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 98
Apply z-direction Gaussian blur with std = 1 px on obja at iter 98
Apply z-direction Gaussian blur with std = 1 px on objp at iter 98
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 98
Apply hard positivity constraint on objp at iter 98
Iter: 98, Total Loss: 0.2306, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.121 sec

Iter: 99, obja.requires_grad = True
Iter: 99, objp.requires_grad = True
Iter: 99, obj_tilts.requires_grad = False
Iter: 99, probe.requires_grad = True
Iter: 99, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.172 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.173 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.173 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.173 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.172 sec
Apply ortho pmode constraint at iter 99, relative pmode power = [0.12  0.115 0.114 0.111 0.111 0.109 0.103 0.093 0.082 0.015 0.014 0.013], probe int sum = 489.4584
Apply fix probe int constraint at iter 99, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 99
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 99
Apply z-direction Gaussian blur with std = 1 px on obja at iter 99
Apply z-direction Gaussian blur with std = 1 px on objp at iter 99
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 99
Apply hard positivity constraint on objp at iter 99
Iter: 99, Total Loss: 0.2305, loss_single: 0.2283, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.156 sec

Iter: 100, obja.requires_grad = True
Iter: 100, objp.requires_grad = True
Iter: 100, obj_tilts.requires_grad = False
Iter: 100, probe.requires_grad = True
Iter: 100, probe_pos_shifts.requires_grad = True
Done batch 1 with 128 indices ([4191, 142, 8247, 2822, 2456]...) in 0.173 sec
Done batch 26 with 128 indices ([3719, 15338, 13656, 11867, 4346]...) in 0.172 sec
Done batch 51 with 128 indices ([15142, 7262, 12989, 13785, 14388]...) in 0.172 sec
Done batch 77 with 128 indices ([8877, 7498, 8561, 1885, 12917]...) in 0.172 sec
Done batch 102 with 128 indices ([8931, 2916, 3127, 8996, 955]...) in 0.172 sec
Done batch 128 with 128 indices ([9779, 7814, 5077, 14772, 10278]...) in 0.173 sec
Apply ortho pmode constraint at iter 100, relative pmode power = [0.12  0.114 0.114 0.112 0.111 0.109 0.103 0.093 0.083 0.015 0.014 0.013], probe int sum = 490.4708
Apply fix probe int constraint at iter 100, probe int sum = 450.4553
Apply lateral (y,x) Gaussian blur with std = 0.2 px on obja at iter 100
Apply lateral (y,x) Gaussian blur with std = 0.2 px on objp at iter 100
Apply z-direction Gaussian blur with std = 1 px on obja at iter 100
Apply z-direction Gaussian blur with std = 1 px on objp at iter 100
Apply hard threshold constraint with thresh = [0.98, 1.02] on obja at iter 100
Apply hard positivity constraint on objp at iter 100
Iter: 100, Total Loss: 0.2306, loss_single: 0.2284, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0022, loss_simlar: 0.0000, in 22.176 sec

Saving summary figures for iter 100

### Finished 100 iterations, averaged iter_t = 22.2 sec ###

### The PtyRADSolver is finished in 2329.601 sec, or 38 min 49.601 sec ###
Fri Oct  4 11:29:06 EDT 2024
